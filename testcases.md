**Pico Test Cases**

| Test No. | Test Scenario | Test Description | Expected output | Observed output | Status |
| --- | --- | --- | --- | --- | --- |
| 1. | Check if all the services are running | Syslog server, syslog engine, nfrwdr and rfwrdr should be running | All should be up and running | All are up and running | Pass |
| 2. | Checking default policy deny | To check if the devsrcip &amp; evtmatch follows the deny policy | The ip&#39;s mentioned in devsrcip &amp; the events mentioned in evtmatch should be allowed. |   |   |
| 3. | Checking default policy allow | To check if the devsrcip &amp; evtmatch follows the allow policy | The ip&#39;s mentioned in devsrcip &amp; the events configured in evtmatch should be denied. |   |   |
| 4. | Checking if the configured number of syslog engines are created or not. | We can change number of syslog engine processes through the pico-config.yaml file | The given number of instances of syslog engine should be created. | The given number of instances of syslog engine are created. | Pass |
| 5. | Checking if the log file is created and the logs are stored in the configured path | We can configure the path of the file  to store the logs through the pico-config.yaml file. | Pico.log file should be created and store the logs in the configured path | Pico.log file is created and the logs are stored in the configured path | Pass |
| 6. | Checking If we can start,stop or restart the services | We can start,stop or restart the services using the pico-run.py file | Respective actions must be executed when passed as an argument with pico-run.py | All the actions are executed properly except stop, the services are stopped for small amount of time and then started again. | Fail |
| 7. | Adding a new ip to the native forwarder | We can add multiple native forwarders by configuring the ip through pico-config.yaml  | New native forwarder instance should be up and running | New native forwarder instance is up and running | Pass |
| 8. | Removing an existing ip from the native forwarder which is not to be used | We can remove any native forwarder instance by removing the ip of the native forwarder we want to remove through pico-config.yaml  | The old instance of native forwarder which is not in used i.e not configured in the pico-config.yaml file must be removed | The old instance of native forwarder which is not in used i.e not configured in the pico-config.yaml file is removed | Pass |
| 9. | Adding a new ip to the raw forwarder | We can add multiple raw forwarders by configuring the ip through pico-config.yaml  | New raw forwarder instance should be up and running | New raw forwarder instance is up and running | Pass |
| 10 | Removing an existing ip from the raw forwarder which is not to be used | We can remove any raw forwarder instance by removing the ip of the raw forwarder we want to remove through pico-config.yaml  | The old instance of raw forwarder which is not in used i.e not configured in the pico-config.yaml file must be removed | The old instance of raw forwarder which is not in used i.e not configured in the pico-config.yaml file is removed | Pass |
| 11. | Checking If queues are created in rabbitmq | Queues must be created when the pico is up and running | One pico inward queue and multiple queues based on the instances of the forwarder should be created  | One pico inward queue and multiple queues based on the instances of the forwarder are created | Pass |
| 12. | Checking If new queue is created in rabbitmq when a new forwarder instance is added | When a new forwarder instance is added through pico-config.yaml, a new temporary queue must be created in the rabbitmq  | New temporary queue should be created in rabbitmq | New temporary queue is created in rabbitmq | Pass |
| 13. | Checking if we are able to send messages from inside the container to outside using zmq. | We have to place the client inside the docker container &amp; the server outside the container to see if the zmq connection is successful and is receiving messages  | The socket should be connected and the messages should be sent from the container to the host machine. | The socket refuses the connection and the messages are not sent. | Fail |
| 14. | Check if the pico inward queue is emptied and forwarded to the pico engine | The data in the pico inward queue must not be overloaded with the data as it is consumed by the pico engine repetitively.  | The pico inward queue must be filled and emptied simultaneously when the pico engine is running | The pico inward queue is filled and emptied simultaneously when the pico engine is running | Pass |
